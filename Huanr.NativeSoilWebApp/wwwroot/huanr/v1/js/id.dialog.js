var dialog=new function(){for(var u="dialog"+(new Date).getTime(),l=this,q=[],w=!1,y=!1,D=function(b){if(b.dialogNode){var a=$id(b.dialogNode).find("div",1)[1],d=$id(a,"div").find("div",1)[0],g=0,e=0,k,c,f,m;d.style.cursor="move";d.onmousedown=function(f){f||(f=b.win.event);var m=Math.max(b.doc.documentElement.scrollTop,b.bod.scrollTop),n=Math.max(b.doc.documentElement.scrollLeft,b.bod.scrollLeft);g=parseInt(a.style.marginLeft)-n-f.clientX;e=parseInt(a.style.marginTop)-m-f.clientY;k=a.offsetWidth;c=a.offsetHeight;d.setCapture?(d.onmousemove=h,d.onmouseup=p,d.setCapture()):(b.doc.addEventListener("mousemove",h,!0),b.doc.addEventListener("mouseup",p,!0))};var h=function(d){var h=$id.getSize(b.doc);f=h.height;m=h.width;null==d&&(d=b.win.event);var h=Math.max(b.doc.documentElement.scrollTop,b.bod.scrollTop),n=Math.max(b.doc.documentElement.scrollLeft,b.bod.scrollLeft),n=d.clientX+g+n,n=0>n?0:n,n=n+k>m?0>m-k?0:m-k:n;d=d.clientY+e+h;d=0>d?0:d;d=d+c>f?0>f-c?0:f-c:d;a.style.marginLeft=n+"px";a.style.marginTop=d+"px";b.doc.selection?b.doc.selection.empty():b.win.getSelection&&b.win.getSelection().removeAllRanges()},p=function(){d.releaseCapture?(d.onmousemove=h,d.onmouseup=p,d.releaseCapture()):(b.doc.removeEventListener("mousemove",h,!0),b.doc.removeEventListener("mouseup",p,!0));d.onmousemove=null;d.onmouseup=null}}},A=function(b,a,d,g){a=null!==a&&-1<a&&101>a?a:0;d=null!==d&&-1<d&&101>d?d:0;var e=null,e=a>d?setInterval(function(){a-=4;a>d?$id(b).cssText("filter:alpha(opacity="+a+");opacity:"+a/100):($id(b).cssText("filter:alpha(opacity="+d+");opacity:"+d/100),clearInterval(e),g())},16):setInterval(function(){a+=4;a<d?$id(b).cssText("filter:alpha(opacity="+a+");opacity:"+a/100):($id(b).cssText("filter:alpha(opacity="+d+");opacity:"+d/100),clearInterval(e),g())},16)},E=function(b,a){a=a?a:"dialogInit";var d=l.doc.getElementById(a);d||(d=document.createElement("div"),d.style.cssText="position:absolute;z-index:9999;left:0;top:0;",d.id=a,$id(d).appendTo(l.bod));return d},B=function(b){var a=0;b=b||event;a=b.keyCode||b.which||b.charCode;if(13==a&&(b=b.target||b.srcElement,!(b&&b.nodeName&&"textarea"==b.nodeName.toLowerCase()||y||w))){var d=l.doc.activeElement,g=!1,e=$id(l.rootNode,"div",1);2>e.length||(e=e.filter("class="+u).last(),e.length&&!$id(e[0]).attribute("notenter")&&setTimeout(function(){var a=e.find("div").filter("class=dialogB").find("input");if($id(a[0]).attribute("index")){if(d)for(var b=0;b<a.length;b++)if(a[b]===d){g=!0;break}g||0<a.length&&$id(a[0]).triggerEvent("click")}},1))}},r={titleStr:"dialog",contentStr:"<center>dialog message</center>",btnConfig:[{text:"\u786e\u5b9a",fun:function(){this.close()}},{text:"\u53d6\u6d88",fun:function(){this.close()}}],showHeader:!0,showCloseBtn:!0,width:318,showed:null,closed:null,enterFun:null},t=window,C=!1;t.parent&&t!==t.parent;)t=t.parent,C=!0;this.win=t;this.doc=t.document;this.isChildPage=C;this.version="version 2.0";this.form=function(){return $id.form(this.contentInit)};this.close=function(z){w=!0;for(var b=0,a=0;b<q.length;b++)if(q[b].index===this.index){a=1;break}if(a){var d=q[b].config.closed;q.splice(b,1);var g=this;1==$id(g.rootNode,"div",1).filter("class="+u).length&&($id(g.bod).removeClass(u),$id(g.doc).removeEvent("keydown",B));g.contentInit.style.visibility='hidden';A(g.dialogNode,50,0,function(){$id(g.dialogNode).remove();var a=$id(g.rootNode,"class=dialog",1).last();a.length&&g.enterKeyAnswer(!0,a[0]);delete g;w=!1;"function"==typeof d&&d();"function"==typeof z&&z()})}else{w=!1;"function"==typeof z&&z()}};this.setBtnDisabled=function(b){b?$id(this.btnInit).find("input").attribute("disabled","disabled"):$id(this.btnInit).find("input").removeAttribute("disabled")};this.enterKeyAnswer=function(b,a){$id(this.rootNode,"class=dialog",1).foreach(function(a){b?$id(this).removeAttribute("notenter"):$id(this).attribute("notenter",1)});a&&(b?$id(a).removeAttribute("notenter"):$id(a).attribute("notenter",1))};this.show=function(b){for(y=!0;!this.bod;)if(this.bod=this.doc.body){this.rootNode=E(this.bod);var a=$id(this.rootNode,"div",1);a.length?this.styleNode=a[0]:(this.styleNode=$id(document.createElement("div")).cssText("display:none").html('&nbsp;<style type="text/css">#dialogInit{position:absolute;padding:0;margin:0;left:0;top:0;width:100%;font-family:"\u5fae\u8f6f\u96c5\u9ed1"}#dialogInit .dialog{position:absolute;padding:0;margin:0;left:0;top:0;width:100%;height:0}#dialogInit .dialogMaskDiv{position:absolute;padding:0;margin:0;left:0;top:0;width:100%;filter:alpha(opacity=70);opacity:.7;background:#fff}#dialogInit .dialogShowDiv{position:absolute;padding:0;margin:0;width:318px;overflow:hidden;border:solid 1px #3079d5;background:#fff}#dialogInit .dialogT{height:40px;line-height:40px;width:100%;overflow:hidden;background:#3079d5;color:#fff}#dialogInit .dialogC{padding:5px;overflow:hidden}#dialogInit .dialogB{height:40px;overflow:hidden;text-align:center;border-top:solid 1px #f90;background:#f2f2f2}#dialogInit .dialogTL{width:100%;height:40px;overflow:hidden;float:left;text-indent:5px;font-weight:500;font-size:20px;background:#3079d5}#dialogInit .dialogTL *{font-weight:500;font-size:20px;display:inline}#dialogInit .dialogTR{width:0;height:40px;overflow:hidden;float:left}#dialogInit .dialogTR span.closeBtn{width:40px;height:30px;background:#fff;border-radius:0 0 0 8px;color:#3079d5;line-height:30px;text-align:center;cursor:pointer;display:block;overflow:hidden;position:absolute;margin:-1px 0 0 -40px}#dialogInit .dialogTR span.closeBtn:hover{background:#f90;color:#fff}#dialogInit .dialogB input{display:inline-block;height:34px;border:solid 1px #f90;color:#f90;background:#fff;padding:0 5px 0 7px;letter-spacing:2px;margin:3px 5px 0 0;overflow:hidden;font-size:14px;font-weight:700;line-height:34px;border-radius:5px;cursor:pointer;outline:0}#dialogInit .dialogB input:focus{outline:0}#dialogInit .dialogB input:hover{background:#f90;color:#fff}#dialogInit .nDialog .dialogMaskDiv{filter:alpha(opacity=70);opacity:.7;background:#fff}</style>')[0],$id(this.styleNode).appendTo(this.rootNode))}$id(this.bod).hasClass(u)||($id(this.bod).addClass(u),$id(this.doc).addEvent("onkeydown",B));if(b)if(b.titleStr=b.titleStr?b.titleStr.toString():r.titleStr,b.contentStr=b.contentStr?b.contentStr.toString():r.contentStr,b.width?(b.width=parseInt(b.width,10),80>b.width&&(b.width=80)):b.width=r.width,void 0==b.showCloseBtn&&(b.showCloseBtn=r.showCloseBtn),b.btnConfig){if(isArray(b.btnConfig)){for(var a=!0,d=0;d<b.btnConfig.length;d++)if(b.btnConfig[d].text&&void 0!=typeof b.btnConfig[d].fun)b.btnConfig[d].text=b.btnConfig[d].text.toString();else{a=!1;break}if(!a)return alert("btnConfig error"),null}else b.btnConfig=r.btnConfig;void 0==b.showHeader&&(b.showHeader=r.showHeader)}else b.btnConfig=null;else b=r;this.enterKeyAnswer(!1);return new function(){for(var a in l)this[a]=l[a];var d=this,k=$id.htmlStrToDom('<div class="dialog '+u+'" style="filter:alpha(opacity=0);opacity:0;"><div class="dialogMaskDiv"></div><div class="dialogShowDiv"><div class="dialogT"><div class="dialogTL"></div><div class="dialogTR"><span class="closeBtn">\u00d7</span></div></div><div class="dialogC"></div><div class="dialogB"></div></div></div>').appendTo(this.rootNode)[0];a=$id(k).find("class=dialogMaskDiv");var c=$id(k).find("class=dialogShowDiv").cssText("visibility:hidden;width:"+b.width+"px")[0],f=$id(k).find("span").first();$id(k).find("class=dialogTL").html(b.titleStr);var m=$id(k).find("class=dialogC").html(b.contentStr),h=$id(k).find("class=dialogB"),p=$id(this.rootNode).find("class=dialog",1).length;this.contentInit=m[0];this.btnInit=h[0];this.dialogNode=k;this.index=p;$id(k).attribute("index",p);1<p?(d.isChildDialog=!0,$id(k).addClass("nDialog")):d.isChildDialog=!1;var v=$id.isPC();b.showCloseBtn?f.addEvent(v?"click":"touchend",function(){d.close()}):f.cssText("display:none");b.showHeader||$id(k).find("class=dialogT").remove();var z=!1;if(b.btnConfig){for(var f=[],n=0;n<b.btnConfig.length;n++)f[f.length]='<input type="button" value="'+b.btnConfig[n].text+'" index="'+n+'" />';h.html(f.join("")).addEvent(v?"click":"touchend",function(a){a=a||window.event;var b=a.target||a.srcElement;b&&b.nodeName&&"input"===b.nodeName.toLowerCase()&&!$id(b).attribute("disabled")&&(b=parseInt($id(b).attribute("index"),10),q.length&&q[q.length-1].config.btnConfig&&q[q.length-1].config.btnConfig[b].fun.apply(d,arguments))})}else h.html('<input type="button" value="" />').cssText("height:0px;overflow:hidden;border:none;"),z=!0;var x=$id.getSize(l.doc);a.cssText("height:"+x.height+"px");q.push({config:b,index:p});this.win.focus();var r=$id(h).find("input");setTimeout(function(){x=$id.getSize(l.win);var a=c.offsetHeight,f=c.offsetWidth,g=x.height,h=x.width;a>g&&(a=g,c.style.height=g-2+"px",m[0].style.height=g-12-(z?0:41)-(b.showHeader?40:0)+"px",m[0].style.overflowY="scroll");f>h&&(f=h,c.style.width=h-2+"px",m[0].style.width=h-12+"px",m[0].style.overflowX="scroll");var n=Math.max(l.doc.documentElement.scrollLeft,l.bod.scrollLeft);c.style.marginTop=g/2-a/2+Math.max(l.doc.documentElement.scrollTop,l.bod.scrollTop)+"px";c.style.marginLeft=h/2-f/2+n+"px";$id(c).cssText("visibility:visible;");r.length&&r[0].focus();v&&b.showHeader&&D(d);$id(d.dialogNode).find("span").first()[0].offsetWidth;"function"===typeof b.showed&&b.showed.apply(d,arguments);A(k,50,100,function(){y=!1})},100)}};this.alert=function(b,a,d,g){return this.show({titleStr:b?b.toString():"alert",contentStr:a,btnConfig:[{text:"\u786e\u5b9a",fun:function(){this.close()}}],width:g,closed:d})};this.confirm=function(b,a,d,g){return this.show({titleStr:b?b.toString():"confirm",contentStr:a,btnConfig:[{text:"\u786e\u5b9a",fun:function(){this.close();d(!0)}},{text:"\u53d6\u6d88",fun:function(){this.close();d(!1)}}],width:g})};this.prompt=function(b,a,d,g){return this.show({titleStr:b?b.toString():"prompt",contentStr:'<input type="text" style="width:96%;display:block;height:40px;line-height:40px;margin:10px auto;" name="prompt_input" value="" />',btnConfig:[{text:"\u786e\u5b9a",fun:function(){d.apply(this,[this.form(this.contentInit).getData().prompt_input])}},{text:"\u53d6\u6d88",fun:function(){this.close()}}],width:g,showed:function(){var b=this.form(this.contentInit).obj.prompt_input;a&&($id(b).attribute("placeholder",a),"placeholder"in document.createElement("input")||(b.onfocus=function(){this.value==a&&(this.value="")},b.onblur=function(){""==this.value&&(this.value=a)}));b.focus()}})};this.tips=function(b,a,d){a=a?a:700;return this.show({titleStr:"tips",contentStr:'<center style="color:#f00;">'+b.toString()+"</center>",width:d,showHeader:!1,showed:function(){var b=this;setTimeout(function(){b.close()},700>a?700:a)}})};this.contentOnly=function(b,a,d){return this.show({contentStr:b,showed:a,width:d,showHeader:!1})};this.waiting=function(b,z){b=b?b:"waiting";b="string"!==typeof b?b.toString():b;var a=null;return this.show({contentStr:'<div style="height:30px;line-height:1;font-size:12px;color:#f00;text-align:center;"><div style="height:14px;overflow:hidden;">'+b+'</div><div n="dot" style="font-size:20px;letter-spacing:3px;font-weight:bold;margin-top:-5px;"></div></div>',showed:function(){var b=$id(this.contentInit,"div").filter("n=dot"),g=20;a=setInterval(function(){g--;1>g&&(g=20);b.html("....................".substr(0,g))},100)},closed:function(){clearInterval(a)},showHeader:!1})};this.loadIframe=function(b,a,d,g,e,k){var c=$id.getSize(this.win);c.height-=10;c.width-=10;g||(g=500);g=0>g?0:g;g=g>c.height?c.height:g;d||(d=500);d=0>d?0:d;d=d>c.width?c.width:d;d=100>d?100:d;return this.show({titleStr:b,contentStr:'<div style="width:'+(d-12)+"px;height:"+((100>g?100:g)-52)+'px;overflow:hidden;padding:0;margin:0;border:0;"></div>',width:d,showHeader:!0,showed:function(){var b=this,c=document.createElement("iframe"),d=$id(this.contentInit).find("div")[0],g=$id.htmlStrToDom('<p style="padding:0;margin:0;width:'+d.offsetWidth+"px;height:"+d.offsetHeight+"px;line-height:"+d.offsetHeight+'px;color:#000;font-size:16px;background:#fff;position:absolute;text-align:center;">\u2026\u2026\u6b63\u5728\u52aa\u529b\u52a0\u8f7d\u2026\u2026</p>').insertBefore(d),v=function(){g&&(g.remove(),g=!1);var a=!0;try{c.contentWindow.parentDialogObj=b,c.contentWindow.focus()}catch(d){console&&console.log&&console.log("onload\u4e8b\u4ef6\u4e0d\u53ef\u7528\uff1a\u52a0\u8f7d\u7684\u9875\u9762\u53ef\u80fd\u4e0d\u662f\u540c\u6e90\u7684URL:"+c.src),a=!1}"function"==typeof e&&(c.dialogObj=b,c.isHomologous=a,e.apply(c,[c]))};b.sendDataToDialogPage=function(a){"function"==typeof k&&k.apply(b,[a])};c.frameBorder=0;c.attachEvent?c.attachEvent("onload",v):c.onload=v;c.src=a;$id(c).cssText("width:100%;height:100%;overflow:hidden;").appendTo(d)},enterFun:null})};this.loadBigImage=function(b,a){var d=this.win,g=dialog.waiting("\u2026\u2026\u6b63\u5728\u6253\u5f00\u56fe\u7247\u2026\u2026"),e=$id.htmlStrToDom('<div style="width:0;height:0;overflow:hidden;padding:0;margin:0;border:0;"></div>').appendTo()[0],k=document.createElement("img"),c=new Date;k.onload=function(){var a=function(){g.close();var a=$id.getSize(d),c=a.height-52,a=a.width-12,e=this.height,f=this.width;e>c&&(f*=c/e,e=c);f>a&&(e*=a/f,f=a);$id(this.parentNode).remove();dialog.show({titleStr:b,contentStr:'<div style="width:'+f+"px;height:"+e+'px;overflow:hidden;padding:0;margin:0;border:0;"><img src="'+this.src+'" width="'+f+'" height="'+e+'" /></div>',width:f+12,showHeader:!0,enterFun:null})},e=(new Date).getTime()-c.getTime();if(1E3>e){var h=this;setTimeout(function(){a.apply(h,[h])},1E3-e)}else a.apply(this,[this])};k.onerror=function(){dialog.tips("\u2026\u2026\u56fe\u7247\u52a0\u8f7d\u9519\u8bef\u2026\u2026",2E3);g.close()};k.src=a;e.appendChild(k)};this.createFormDialog=function(b,a,d,g){var e={nameArray:["userName","userPassword"],textArray:["\u7528\u6237\u540d","\u767b\u5f55\u5bc6\u7801"],valueArray:[],typeArray:["text","password"],checkedArray:[]};a?(isArray(a.nameArray)||(a.nameArray=[a.nameArray.toString()]),isArray(a.textArray)||(a.textArray=a.nameArray),isArray(a.valueArray)||(a.valueArray=[]),isArray(a.typeArray)||(a.typeArray=[]),isArray(a.checkedArray)||(a.checkedArray=[])):a=e;for(var e=['<table style="margin:0 auto;"><tbody>'],k=function(a,b){for(var c=0;c<b.length;c++)if(b[c]==a)return!0;return!1},c=0;c<a.nameArray.length;c++){var f=['<tr><th style="text-align:right;vertical-align:top;">'];f[f.length]=a.textArray[c]?a.textArray[c].toString():a.nameArray[c].toString();f[f.length]="\uff1a</th><td>";switch(a.typeArray[c]){case"textarea":e[e.length]=f.join("");e[e.length]='<textarea style="width:500px;" rows="5" name="'+(a.nameArray[c]?a.nameArray[c].toString():"textarea"+(c+1))+'">'+(a.valueArray[c]?a.valueArray[c].toString():"")+"</textarea>";break;case"text":e[e.length]=f.join("");e[e.length]='<input type="text" style="width:500px;" value="'+(a.valueArray[c]?a.valueArray[c].toString():"")+'" name="'+(a.nameArray[c]?a.nameArray[c].toString():"text"+(c+1))+'" />';break;case"tel":e[e.length]=f.join("");e[e.length]='<input type="tel" style="width:500px;" value="'+(a.valueArray[c]?a.valueArray[c].toString():"")+'" name="'+(a.nameArray[c]?a.nameArray[c].toString():"tel"+(c+1))+'" />';break;case"password":e[e.length]=f.join("");e[e.length]='<input type="password" style="width:500px;" value="'+(a.valueArray[c]?a.valueArray[c].toString():"")+'" name="'+(a.nameArray[c]?a.nameArray[c].toString():"password"+(c+1))+'" />';break;case"hidden":e[e.length]='<tr style="display:none;"><th style="text-align:right;vertical-align:top;">';e[e.length]=a.textArray[c]?a.textArray[c].toString():a.nameArray[c].toString();e[e.length]="\uff1a</th><td>";e[e.length]='<input type="hidden" style="width:500px;" value="'+(a.valueArray[c]?a.valueArray[c].toString():"")+'" name="'+(a.nameArray[c]?a.nameArray[c].toString():"hidden"+(c+1))+'" />';break;case"checkbox":e[e.length]=f.join("");isArray(a.valueArray[c])||(a.valueArray[c]=[a.valueArray[c].toString()]);isArray(a.checkedArray[c])||(a.checkedArray[c]=[a.checkedArray[c]]);for(f=0;f<a.valueArray[c].length;f++){var m="checkbox"+(c+1)+"_"+(f+1),h=a.valueArray[c][f][0].toString(),p=a.valueArray[c][f][1]?a.valueArray[c][f][1].toString():h,l=k(f,a.checkedArray[c]);e[e.length]='<label for="'+m+'" style="margin:0 10px 0 0;display:inline-block;"><input type="checkbox" id="'+m+'" name="'+(a.nameArray[c]?a.nameArray[c].toString():"checkbox"+(c+1))+'" value="'+p+'"'+(l?' checked="checked"':"")+" />"+h+"</label>"}break;case"radio":e[e.length]=f.join("");isArray(a.valueArray[c])||(a.valueArray[c]=[a.valueArray[c].toString()]);isArray(a.checkedArray[c])||(a.checkedArray[c]=[a.checkedArray[c]]);for(f=0;f<a.valueArray[c].length;f++)m="radio"+(c+1)+"_"+(f+1),h=a.valueArray[c][f][0].toString(),p=a.valueArray[c][f][1]?a.valueArray[c][f][1].toString():h,l=k(f,a.checkedArray[c]),e[e.length]='<label for="'+m+'" style="margin:0 10px 0 0;display:inline-block;"><input type="radio" id="'+m+'" name="'+(a.nameArray[c]?a.nameArray[c].toString():"radio"+(c+1))+'" value="'+p+'"'+(l?' checked="checked"':"")+" />"+h+"</label>";break;case"select":e[e.length]=f.join("");e[e.length]='<select style="width:500px;" name="'+(a.nameArray[c]?a.nameArray[c].toString():"select"+(c+1))+'">';isArray(a.valueArray[c])||(a.valueArray[c]=[a.valueArray[c].toString()]);isArray(a.checkedArray[c])||(a.checkedArray[c]=[a.checkedArray[c]]);for(f=0;f<a.valueArray[c].length;f++)h=a.valueArray[c][f][0].toString(),p=a.valueArray[c][f][1]?a.valueArray[c][f][1].toString():h,l=k(f,a.checkedArray[c]),e[e.length]='<option value="'+p+'"'+(l?' selected="selected"':"")+">"+h+"</option>";e[e.length]="</select>";break;default:e[e.length]=f.join(""),e[e.length]='<input type="text" style="width:500px;" value="'+(a.valueArray[c]?a.valueArray[c].toString():"")+'" name="'+(a.nameArray[c]?a.nameArray[c].toString():"text"+(c+1))+'" />'}e[e.length]=["</td></tr>"]}e[e.length]=["</tbody></table>"];return this.show({titleStr:b,contentStr:e.join(""),width:660,showHeader:!0,enterFun:null,btnConfig:[{text:"\u63d0\u4ea4",fun:d},{text:"\u53d6\u6d88",fun:function(){this.close()}}],showed:g})}};